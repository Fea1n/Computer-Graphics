## **照相机、镜头和光场**

### **成像**

- 成像 = 合成+捕捉
- 最早的相机是通过小孔成像的原理来成像的，现在的针孔相机也是使用这个原理
- 快门控制光能在相机中待多长时间
- 传感器（Sensor）记录的是光的Irradiance信息
- 针孔摄像机没有透镜，因此做不成景深

### **视场(FOV)**

- FOV是相机的可视角度范围
- FOV=2arctan（h/2f）其中h为传感器高度，f为焦距
- 因此视场与传感器大小、焦距均有关
- 手机摄像头通过同时减少焦距和传感器大小以求得到和相机类似的FOV

### **曝光**

- Exposure = time * irradiance，曝光=时间*Irradiance
- 时间由快门控制，irradiance由光圈的大小和焦距控制
- 快门速度慢，曝光时间长，光在感光器上停留时间长，会产生运动模糊的现象
- 对于机械快门，如果拍摄高速物体会产生运动扭曲的现象
- 光圈的大小控制单位时间内的进光量，光圈可以制造景深，光圈越大景深越明显
- 通过F数（F/N）来描述光圈的大小，F数是焦距/光圈直径（N=f/D）
- 因此运动模糊和景深无法同时出现
- ISO是一个后期的处理值通过乘上ISO来改变整体的明暗
- ISO也可以在硬件上进行改变，比如改变感光器的灵敏度
- ISO过大会产生噪声，因此一般不直接大范围调整ISO来提高亮度
- 通过很长的曝光时间应用于延时摄影上

### **镜头（透镜）**

- 真实的透镜是由很多块玻璃叠在一起制作而成的
- 薄透镜对于平行光会集中在一个点，被称之为焦点
- 目前的相机通过多块透镜的组合可以制作出不同的焦距
- 课程中我们考虑的是理想的薄透镜，同时可以任意改变焦距
- 物距、相距、焦距之间的关系：1/f=（1/zi）+（1/z0）其中f为焦距，zi为相距，z0为物距
- 在焦点前后，光线开始聚集和扩散，点的影象变成模糊的，形成一个扩大的圆，这个圆就叫做CoC
- 离焦模糊是在拍照时，被摄物体不在焦点，使得成像不是清晰的一个点，而是变成coc，coc随着光圈的增加而增大。
- coc的宽度：C/A=d'/zi=|zs-zi|/zi
- 其中zs为透镜到coc的距离，A为镜头的直径，d'为zs-zi的绝对值

### **光线追踪与薄透镜**

![img](https://pic3.zhimg.com/80/v2-fce796caecd4d3e2effba7cbded7220a_1440w.jpg)

实现步骤：

- 首先确定成像平面的大小、透镜本身的焦距和光圈大小
- 然后定义透镜与拍摄平面的物距z0
- 根据前两项确定的数据算出像距zi
- 在成像平面上选一个点x''
- 在透镜上选另一个点x''
- 连接x'和透镜中心点并延长，与subject plane相交得到交点x'''，这样我们就可以知道x'''→x''这条光线最终会被记录在x'点上
- 因此我们只需要考虑x''→x''这条光线上的radiance，算出来记到x'上。

### **景深**

- 场景中的光经过透镜，打到成像平面，在成像平面附近的某个区域，这个区域内CoC都是足够小的。
- 当CoC足够小，我们就认为这个地方是清晰的，而这一区域就被我们成为景深（DOF）
- 景深外的模糊的范围会因光圈大小而变化
- 下面是DOF的计算公式

![img](https://pic2.zhimg.com/80/v2-d2a6b3ea1dc606fda453d4d6918f19d1_1440w.jpg)

### **光场**

- 我们通过全光函数P(θ，φ)用于描述我们能看到的所有东西
- 引入波长λ让其拥有色彩，P(θ，φ ，λ)
- 引入时间t让画面可以看到不同时间的场景，P(θ，φ ，λ，t)
- 引入摄像机的位置Vx、Vy、Vz，可以在任意位置观察场景，P(θ，φ ，λ，t，Vx，Vy，Vz)
- 可以将视觉定义成一个七维的函数这个函数也就是全光函数，P(θ，φ ，λ，t，Vx，Vy，Vz)
- 光场是全光函数的一部分P(θ，φ ，Vx，Vy，Vz)，是在任意位置任意方向光的物理量
- 人们法线只需要四维信息就可以定义光的物理量: 2D位置信息（u，v）+ 2D方向信息(θ，φ)
- 我们同样可以通过获取一束光在两个平行平面（s，t）和（u，v）上的位置来确定光的位置

![img](https://pic4.zhimg.com/80/v2-a262d5a56e375ad1dae2fba37f5a280b_1440w.jpg)

- 一般相机的传感器接收到信息是三维到二维的投影，损失了深度,记录的是Irradiance
- 光场相机通过棱镜分光将的每一块单位面积记录了光场的所有信息Radiance（u,v,s,t）
- 由于记录了光线的Radiance，可以通过仅观察某个方向的光线，同时可以观察特定方向的光线实现聚焦的功能
- 光场相机由于需要多个传感器才能记录一个像素的信息因此分辨率不足，同时由于棱镜精密因此高成本

![img](https://pic1.zhimg.com/80/v2-e0fa0bc5581a72a0574c19bddd99de44_1440w.jpg)